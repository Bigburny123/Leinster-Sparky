<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Leinster Sparky — Instant Quote</title>
<style>
/* === Basic styles (preserve your original layout) === */
body{font-family:Arial,sans-serif;margin:0;padding:0;background:#f3f8f4;color:#07121a;}
.wrap{max-width:1100px;margin:28px auto;padding:20px;}
header{display:flex;align-items:center;gap:16px;}
.logo{width:72px;height:72px;border-radius:14px;background:linear-gradient(135deg,#2b8a3e,#f5c200);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:800;font-size:22px;}
h1{margin:0;font-size:22px;}
p.lead{margin:6px 0 20px;color:#51606a;}
.grid{display:grid;grid-template-columns:1fr 380px;gap:20px;}
@media (max-width:980px){.grid{grid-template-columns:1fr;}}
.card{background:#fff;padding:18px;border-radius:12px;box-shadow:0 6px 18px rgba(11,18,32,0.04);}
label{display:block;font-size:13px;color:#51606a;margin-bottom:8px;}
select,input,textarea{width:100%;padding:10px;border-radius:10px;border:1px solid #e8f0ed;font-size:15px;}
.row{display:flex;gap:12px;}
.row> *{flex:1;}
.service-item{display:flex;justify-content:space-between;margin-bottom:6px;}
button.primary{background:linear-gradient(90deg,#2b8a3e,#1e7f2f);color:#fff;padding:12px 18px;border-radius:10px;border:0;font-weight:700;cursor:pointer;}
button.ghost{background:transparent;border:1px solid #e6eef3;padding:10px 14px;border-radius:10px;cursor:pointer;}
.summary .total{font-size:28px;font-weight:900;margin:0;}
.summary .muted{color:#51606a;font-size:13px;}
</style>
</head>
<body>
<div class="wrap">
<header>
  <div class="logo">LS</div>
  <div>
    <h1>Leinster Sparky</h1>
    <p class="lead">Instant online estimates for domestic electrical work — fast, clear and mobile-friendly.</p>
  </div>
</header>

<main class="grid">
<section class="card">
<h2 style="margin-top:0">Build your quote</h2>

<label for="serviceSelect">Select a service</label>
<select id="serviceSelect">
  <option value="assessment">Assessment / Callout</option>
  <option value="sockets">Socket replacement / installation</option>
  <option value="lighting">Light fitting or replacement</option>
  <option value="rewire">Partial rewire (per room)</option>
  <option value="fuse">Fuseboard / consumer unit</option>
  <option value="ev">EV charger (supply & fit)</option>
  <option value="inspection">Inspection & certificate</option>
  <option value="custom">Custom (describe below)</option>
</select>

<div style="margin-top:12px" id="customInputContainer"></div>

<label style="margin-top:12px">Quantity</label>
<input type="number" id="qtyInput" min="1" value="1">

<div style="margin-top:12px;display:flex;gap:10px;">
  <button id="addServiceBtn" class="primary">Add to quote</button>
  <button id="resetBtn" class="ghost">Reset</button>
</div>

<h3 style="margin-top:20px">Current quote</h3>
<div id="quoteList"></div>

<label style="margin-top:12px">Notes / description</label>
<textarea id="notes" rows="3" placeholder="Optional notes"></textarea>

<div style="margin-top:12px" class="row">
  <input id="custName" placeholder="Your name">
  <input id="custEmail" placeholder="Your email">
</div>
<div style="margin-top:12px" class="row">
  <input id="custPhone" placeholder="Phone">
  <input id="custPost" placeholder="Postcode / Town">
</div>

<div style="margin-top:12px">
  <button id="previewBtn" class="primary">Preview estimate</button>
</div>

</section>

<aside class="summary card">
<div>
  <div class="muted">Estimate total</div>
  <div class="total" id="totalAmount">€0</div>
</div>
<div style="margin-top:12px" id="breakdown"></div>
</aside>
</main>
</div>

<script>
const CONFIG = {
  currency:'€',
  businessName:'Leinster Sparky',
  OWNER_EMAIL:'ryanbyrne1412@gmail.com'
};

const PRICES = {
  general: {label:'Assessment / Callout', unit:45},
  sockets: {label:'Socket (single)', unit:30},
  lighting: {label:'Light fitting', unit:30},
  rewire: {label:'Partial rewire (per room)', unit:420},
  fuse: {label:'Fuseboard upgrade', unit:650},
  ev: {label:'EV charger (supply & fit)', unit:1200},
  inspection: {label:'Inspection & certificate', unit:85},
  custom: {label:'Custom item', unit:0}
};

const EXTRA_PRICES = {callout:45, certificate:60, weekend:80, smart:35};
const SMALL_TYPES = ['sockets','lighting','smart'];

let quoteList = []; // stores all added services

// DOM elements
const serviceSelect = document.getElementById('serviceSelect');
const dynamicOptions = document.getElementById('dynamicOptions');
const extrasList = document.getElementById('extrasList');
const notes = document.getElementById('notes');
const liveTotal = document.getElementById('liveTotal');
const breakdown = document.getElementById('breakdown');
const previewBtn = document.getElementById('previewBtn');
const modal = document.getElementById('modal');
const modalBody = document.getElementById('modalBody');
const modalTotal = document.getElementById('modalTotal');
const closeModal = document.getElementById('closeModal');
const custName = document.getElementById('custName');
const custEmail = document.getElementById('custEmail');
const custPhone = document.getElementById('custPhone');
const custPost = document.getElementById('custPost');
const sendToCustomer = document.getElementById('sendToCustomer');
const sendToOwner = document.getElementById('sendToOwner');
const resetBtn = document.getElementById('resetBtn');
const downloadBtn = document.getElementById('downloadBtn');

// Render quantity input
function renderDynamicOptions(){
  const s = serviceSelect.value;
  dynamicOptions.innerHTML = '';
  let html='';
  if(s==='custom'){
    html += `<label>Custom item title</label><input id='customTitle' placeholder='e.g. install new consumer unit'>`;
    html += `<label style='margin-top:10px'>Estimated units / qty</label><input id='customQty' type='number' min='1' value='1'>`;
  } else {
    html += `<label>Quantity</label><input id='qty' type='number' min='1' value='1'>`;
  }
  const priceLabel = PRICES[s]?PRICES[s].unit:0;
  const fromText = (s==='rewire'||s==='fuse'||s==='ev')?'from ':'';
  html += `<div class="muted" style="margin-top:8px">Unit price: ${fromText}${CONFIG.currency}${priceLabel} (${PRICES[s]?PRICES[s].label:''})</div>`;
  const addBtn = document.createElement('button');
  addBtn.textContent='Add to quote';
  addBtn.className='primary';
  dynamicOptions.innerHTML = html;
  dynamicOptions.appendChild(addBtn);

  addBtn.addEventListener('click',()=>{
    let qty=1,label=PRICES[s].label,unit=PRICES[s].unit;
    if(s==='custom'){
      const customTitle=document.getElementById('customTitle');
      const customQty=document.getElementById('customQty');
      if(customTitle && customTitle.value.trim()!=='') label=customTitle.value.trim();
      if(customQty) qty=parseInt(customQty.value)||1;
    } else {
      const qtyInput=document.getElementById('qty');
      if(qtyInput) qty=parseInt(qtyInput.value)||1;
    }
    // Extras
    const selectedExtras={};
    extrasList.querySelectorAll('input[type=checkbox]').forEach(cb=>{
      if(cb.checked) selectedExtras[cb.dataset.extra]=true;
    });
    quoteList.push({service:s,label,qty,unit,extras:selectedExtras});
    calculate();
  });
}

// Calculate total with discounts
function calculate(){
  let total=0;
  breakdown.innerHTML='';
  let smallCount=0;
  quoteList.forEach(item=>{
    const itemTotal=item.unit*item.qty;
    total+=itemTotal;
    const div=document.createElement('div');
    div.textContent=`${item.label} x ${item.qty} = ${CONFIG.currency}${itemTotal}`;
    breakdown.appendChild(div);
    SMALL_TYPES.forEach(st=>{
      if(item.service===st || item.extras[st]) smallCount+=item.qty;
    });
    // Extras line
    for(const k in item.extras){
      if(EXTRA_PRICES[k]){
        const eTotal=EXTRA_PRICES[k];
        total+=eTotal;
        const eDiv=document.createElement('div');
        eDiv.textContent=`${k} = ${CONFIG.currency}${eTotal}`;
        breakdown.appendChild(eDiv);
        if(SMALL_TYPES.includes(k)) smallCount+=1;
      }
    }
  });

  // Discount
  let discountPct=0;
  if(smallCount>=5) discountPct=0.15;
  else if(smallCount>=3) discountPct=0.10;
  const discountAmt=Math.round(total*discountPct);
  total-=discountAmt;
  if(discountAmt>0){
    const div=document.createElement('div');
    div.textContent=`Discount applied: -${CONFIG.currency}${discountAmt} (${Math.round(discountPct*100)}%)`;
    breakdown.appendChild(div);
  }

  liveTotal.textContent=`${CONFIG.currency}${total}`;
}

// Preview modal
previewBtn.addEventListener('click',()=>{
  modalBody.innerHTML='';
  const custInfo=`<div><strong>Customer</strong>: ${custName.value || '—'}<br>${custEmail.value ? custEmail.value+'<br>':''}${custPhone.value ? custPhone.value+'<br>':''}${custPost.value ? custPost.value+'<br>':''}</div>`;
  modalBody.innerHTML+=custInfo+'<hr><div><strong>Estimate</strong></div>';
  let subtotal=0;
  quoteList.forEach(item=>{
    let lineTotal=item.unit*item.qty;
    subtotal+=lineTotal;
    modalBody.innerHTML+=`<div>${item.label} x ${item.qty} = ${CONFIG.currency}${lineTotal}</div>`;
    for(const k in item.extras){
      if(EXTRA_PRICES[k]){
        subtotal+=EXTRA_PRICES[k];
        modalBody.innerHTML+=`<div>${k} = ${CONFIG.currency}${EXTRA_PRICES[k]}</div>`;
      }
    }
  });
  // Discount
  let smallCount=0;
  quoteList.forEach(item=>{
    SMALL_TYPES.forEach(st=>{
      if(item.service===st || item.extras[st]) smallCount+=item.qty;
    });
  });
  let discountPct=0;
  if(smallCount>=5) discountPct=0.15;
  else if(smallCount>=3) discountPct=0.10;
  const discountAmt=Math.round(subtotal*discountPct);
  subtotal-=discountAmt;
  if(discountAmt>0) modalBody.innerHTML+=`<div>Discount applied: -${CONFIG.currency}${discountAmt} (${Math.round(discountPct*100)}%)</div>`;
  modalTotal.textContent=`${CONFIG.currency}${subtotal}`;
  modal.classList.add('open');
});

closeModal.addEventListener('click',()=>modal.classList.remove('open'));

// Reset
resetBtn.addEventListener('click',()=>{
  quoteList=[];
  serviceSelect.value='general';
  document.querySelectorAll('#extrasList input[type=checkbox]').forEach(cb=>cb.c

</body>
</html>
